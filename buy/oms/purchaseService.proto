syntax = "proto3";
package services;
option go_package = ".;services";
import "common/base.proto";
import "orderService.proto";
import "orderAddressService.proto";
import "couponInfoService.proto";

//下单操作
service PurchaseService {
    //填写订单
    rpc Write (PurchaseRequest) returns (PurchaseResponse) {}
    //提交订单
    rpc Submit (PurchaseRequest) returns (OrderResponse) {}
    //充值下单
    rpc Recharge (PurchaseRequest) returns (OrderResponse) {}
}

message Purchase {
    float available_balance =1;//可使用的余额
    int32 available_points =2;//可使用的积分数
    CouponInfo available_coupons = 3;//可使用的优惠劵集合
    OrderAddress order_address =4;//订单收货地址
    repeated shop shop_list = 5;//商品中涉及到那些卖家（多店铺模式下）
    repeated shipment shipment_list = 6; //可选的配送方式
    repeated payment payment_list = 7; //可选的支付方式
    message shop {
        int64 id =1;
        string name =2;
        int64 logo_id =3;
        string logo_url =4;
    }
    message payment {
        int32 id = 1;
        string code =2;
        string name =3;
        int64 icon_id =5;
        string icon_url =6;
        bool is_cod =7;
        bool is_online =8;
        string memo =9;
        string status =10;
    }
    message shipment {
        int32 id = 1;
        string code =2;
        string name =3;
        int64 icon_id =4;
        string icon_url =5;
        string status =6;
    }
}


//下单请求参数
message PurchaseRequest {
    string type = 1; //订单类型（默认为普通订单）
    int64 address_id = 2; //收货地址ID
    string postscript = 3; //买家留言(50字以内)
    string shipment_method = 4; //选中的配送方式
    string payment_method = 5; //选中的支付方式
    string terminal = 6; //下单来源终端：site/app/wx_mini/ali_mini/h5/pos
    int64 coupon_id = 7; //选中的优惠劵凭证ID
    int32 integral = 8; //使用的积分数
    int32 surplus = 9; //使用的余额数
    int64 agent_member_id = 10; //代理的客户ID（操作员代客下单）
    float recharge_money =11; //订单金额【充值订单】
    string recharge_subject =12; //订单标题【充值订单】
    map<int64,int32> sku_list =13; //购买的商品清单
    map<string,string> metas = 14; //订单扩展信息
    map<int64,string> postscripts =15;//多店铺模式下给各个商家的留言
}

message PurchaseData {
    Purchase entity = 1;
    Order order =2;
    PurchaseRequest request =3;//请求数据原始返回
    map<string,string> params = 4;
    common.Info info = 5;
}

message PurchaseResponse {
    PurchaseData data = 1;
    common.Error error = 2;
}
