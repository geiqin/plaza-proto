syntax = "proto3";
package services;
option go_package = ".;services";
import "common/base.proto";
import "orderDetailService.proto";
import "orderAddressService.proto";
import "orderPromotionService.proto";
import "orderCouponService.proto";
import "memberInfoService.proto";

//订单
service OrderService {
    //修改价格
    rpc ModifyPrice (Order) returns (OrderResponse) {}
    //修改地址
    rpc ModifyAddress (Order) returns (OrderResponse) {}
    //撤销订单
    rpc Cancel (Order) returns (OrderResponse) {}
    //删除订单
    rpc Delete (Order) returns (OrderResponse) {}
    //订单追加备注
    rpc AppendRemark (OrderRequest) returns (OrderResponse) {}
    //确认订单(接单/拒单操作)
    rpc ConfirmOrder(OrderRequest) returns (OrderResponse) {}
    //确认已收货
    rpc ConfirmReceived(OrderRequest) returns (OrderResponse) {}
    //确认已结算操作
    //结算订单(无法通过正常流程完成订单,需要商家主动完成订单)
    //适用订单: 堂食餐后付款订单、货到付款订单、外卖餐到付款订单
    rpc ConfirmSettled (OrderRequest) returns (OrderResponse) {}
    //扫码核销订单
    rpc Verification (OrderRequest) returns (OrderResponse) {}

    //获取订单信息
    rpc Get (Order) returns (OrderResponse) {}
    //显示订单信息(详细信息)
    rpc Display (Order) returns (OrderResponse) {}
    //前端显示订单信息(详细信息)
    rpc FrontDisplay (Order) returns (OrderResponse) {}
    //查询订单
    rpc Search (OrderRequest) returns (OrderResponse) {}
    //按条件获取订单列表
    rpc List (OrderRequest) returns (OrderResponse) {}
    //获取订单赠送\使用的优惠券列表
    rpc GetCouponList (OrderRequest) returns (OrderResponse) {}
}

message Order {
    int64  id =1;
    string order_sn =2;
    string type =3;
    int64 shop_id =4;
    int64 member_id =6;
    int32 total_num =7;
    float total_weight =8;
    string currency =9;
    float goods_amount =11;
    float discount_amount =12;
    float shipping_fee =13;
    float insure_fee =14;
    float pack_fee =15;
    float surplus =16;
    float coupon_money =17;
    int32 integral =18;
    float integral_money =19;
    float amount =20;
    float paid_money =21;
    string subject =22;
    string body =23;
    int64 cover_id =24;
    string cover_url =25;
    string postscript =26;
    string to_buyer =27;
    string pay_note =28;
    string referer =29;
    bool is_cod =30;
    bool is_invoiced =31;
    bool is_modified =32;
    bool is_paid =33;
    bool is_safeguard =34;
    bool is_separate =35;
    bool is_shipment =36;
    bool is_refunded =37;
    bool is_payment_timeout =38;
    bool is_return_timeout =39;
    int32 shipping_id =40;
    string shipping_name =41;
    int64 pay_id =42;
    string pay_name =43;
    int32 pack_id =44;
    int64 coupon_id =45;
    string extension_code =46;
    int64 extension_id =47;
    int64 parent_id =48;
    string shipping_status =49;
    string order_status =50;
    string pay_status =51;
    string display_status =52;
    string payment_expire_date =53;
    string return_expire_date =54;
    string confirm_at =55;
    string shipped_at =56;
    string signed_at =57;
    string refunded_at =58;
    string finished_at =59;
    string created_at =60;
    string updated_at =61;
    OrderAddress address =62;
    MemberInfo member = 63;
    repeated OrderDetail details = 64;
    repeated OrderCoupon coupons = 65;
    repeated OrderPromotion promotions = 66;
    map<string,string> metas =67;
}

message OrderRequest {
    int32 paged =1;
    int32 page_size =2;
    string	keywords =3;
    //----------
    int64 id = 4;
    string order_sn = 5;
    string type = 6;
    int64 shop_id =7;
    int64 member_id  =8;
    int32 pay_type = 9;
    bool is_shipment = 10;
    bool is_cod = 13;
    bool is_invoiced = 14;
    bool is_modified = 15;
    bool is_paid = 16;
    bool is_safeguard = 17;
    bool is_separate = 18;
    int32 shipping_id = 19;
    string shipping_name =20;
    int64 pay_id =21;
    string pay_name =22;
    int32 pack_id =23;
    int64 coupon_id =24;
    string extension_code =25;
    int64 extension_id =26;
    string shipping_status =27;
    string order_status =28;
    string pay_status =29;
    string display_status =30;
    string start_date = 31;
    string end_date = 32;
    repeated int64 ids = 33;
}

message OrderData {
    Order entity = 1;
    common.Pager pager =2;
    repeated Order items = 3;
    common.Info info =4;
}

message OrderResponse {
    OrderData data = 1;
    common.Error error = 2;
}
