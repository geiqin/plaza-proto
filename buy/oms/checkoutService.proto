syntax = "proto3";
package services;
option go_package = ".;services";
import "common/base.proto";
import "orderService.proto";
import "orderAddressService.proto";
import "couponInfoService.proto";
import "paymentService.proto";
import "shipmentService.proto";

//结账台操作
service CheckoutService {
    //填写订单
    rpc Write (CheckoutRequest) returns (CheckoutResponse) {}
    //提交订单
    rpc Submit (CheckoutRequest) returns (CheckoutResponse) {}
    //充值下单
    rpc Recharge (CheckoutRequest) returns (CheckoutResponse) {}
}

message Checkout {
    string checkout_id = 1; //结账台ID
    int64 available_surplus =2;//可使用的余额
    int32 available_points =3;//可使用的积分数
    CouponInfo available_coupons = 4;//可使用的优惠劵集合
    OrderAddress shipping_address =5;//订单收货地址
    repeated shop shop_list = 6;//商品中涉及到那些卖家（多店铺模式下）
    repeated Shipment shipment_list = 7; //可选的配送方式
    repeated Payment payment_list = 8; //可选的支付方式
    message shop {
        int64 id =1;
        string name =2;
        int64 logo_id =3;
        string logo_url =4;
    }
}

//结账台请求参数
message CheckoutRequest {
    string checkout_id = 1; //结账台ID
    string order_type = 2; //订单类型（默认为普通订单）
    int64 address_id = 3; //收货地址ID
    string postscript = 4; //买家留言(50字以内)
    int32 shipment_id = 5; //选中的配送方式
    int32 payment_id = 6; //选中的支付方式
    string terminal = 7; //下单来源终端：site/app/wx_mini/ali_mini/h5/pos
    int64 coupon_id = 8; //选中的优惠劵凭证ID
    int32 integral = 9; //使用的积分数
    int64 surplus = 10; //使用的余额数
    int64 agent_member_id = 11; //代理的客户ID（操作员代客下单）
    float recharge_money =12; //订单金额【充值订单】
    string recharge_subject =13; //订单标题【充值订单】
    map<int64,int32> sku_list =14; //购买的商品清单
    map<string,string> metas = 15; //订单扩展信息
    map<int64,string> postscripts =16;//多店铺模式下给各个商家的留言
}

message CheckoutData {
    Checkout entity = 1;
    Order scheme =2;
    Order order =3;
    CheckoutRequest request =4;//请求数据原始返回
    map<string,string> params = 5;
    common.Info info = 6;
}

message CheckoutResponse {
    CheckoutData data = 1;
    common.Error error = 2;
}
