syntax = "proto3";
package services;
option go_package = "/.;services";
import "common/base.proto";
import "orderService.proto";
import "orderAddressService.proto";
import "paymentService.proto";
import "shipmentService.proto";
import "baseInfoService.proto";
import "adjustmentService.proto";

//结账台操作
service CheckoutService {
    //填写订单
    rpc Write (CheckoutRequest) returns (CheckoutResponse) {}
    //提交订单
    rpc Submit (CheckoutRequest) returns (CheckoutResponse) {}
    //充值下单
    rpc Recharge (CheckoutRequest) returns (CheckoutResponse) {}
}

//结算信息
message Checkout {
    string checkout_id =1; //货币类型
    string currency =2; //货币类型
    int32 total_num =3; //总数量
    int64 total_weight =4; //总重量
    int64 total_price =5; //销售总格
    int64 total_discount =6;//优惠总额
    int64 total_amount =7;//应付金额
    int64 pay_money =8;//支付现金
    int64 freight_fee =9; //运费
    int64 insure_fee =10; //保险费
    int64 pack_fee =11; //包装费
    int64 surplus =12;//使用账户余额
    int64 coupon_id = 13;//使用优惠劵ID
    int64 coupon_money =14; //使用优惠劵金额
    int64 integral =15; //积分数量
    int64 integral_money =16;//积分金额
    int64 paid_money =17;//已支付现金
    int64 member_id =18;//会员ID
    bool is_shipment =19;//是否物流
    repeated CheckoutSkuInfo skus = 20; //购买商品列表
    repeated CouponInfo coupons = 21; //可获得的优惠
    repeated PromotionInfo promotions = 22; //参与的活动
    repeated Adjustment  adjustments =23;//变动记录
    repeated SkuInfo presents =24; //可获得的赠品
    //available
    int64 available_surplus =25;//可使用的余额
    int64 available_integral =26;//可使用的积分
    CouponInfo available_coupons = 27;//可使用的优惠劵集合
    OrderAddress shipping_address =28;//订单收货地址
    Shipment shipment_list =29;//订单收货地址
    Payment payment_list =30;//订单收货地址
}

//购买商品信息
message CheckoutSkuInfo {
    int64	sku_id =1;
    int32 num =2;
    int64 price = 3;
    int64 promotion_price = 4;
    int64 member_price = 5;
    int64 subtotal_price = 6;
    int64 subtotal_discount = 7;
    int64 subtotal_amount = 8;
    SkuInfo sku =9;
    repeated PromotionInfo promotions = 10;
}

//结账台请求参数
message CheckoutRequest {
    string checkout_id = 1; //结账台ID
    string order_type = 2; //订单类型（默认为普通订单）
    int64 address_id = 3; //收货地址ID
    string postscript = 4; //买家留言(50字以内)
    int32 shipment_id = 5; //选中的配送方式
    int32 payment_id = 6; //选中的支付方式
    string terminal = 7; //下单来源终端：site/app/wx_mini/ali_mini/h5/pos
    int64 coupon_id = 8; //选中的优惠劵凭证ID
    int64 integral = 9; //使用的积分数
    int64 surplus = 10; //使用的余额数
    int64 agent_member_id = 11; //代理的客户ID（操作员代客下单）
    int64 recharge_money =12; //订单金额【充值订单】
    string recharge_subject =13; //订单标题【充值订单】
    int64 direct_sku_id =14; //直接购买SkuId
    string cart_code =15;////购物车Code
    repeated shop shops = 16; //多店铺数据提交
    message shop {
        int64 shop_id = 1; //分店ID
        int32 shipment_id = 2; //选中的配送方式
        string postscript  =3;//商家的留言
    }
}

message CheckoutData {
    Checkout checkout = 1;//结算信息
    Order order =2;//订单信息
    CheckoutRequest request =3;//请求数据原始返回
    map<string,string> params = 5; //扩展信息
}

message CheckoutResponse {
    CheckoutData data = 1;
    common.Error error = 2;
}
