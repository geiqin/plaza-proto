syntax = "proto3";
package services;
option go_package = "/.;services";
import "common/base.proto";
import "skuInfoService.proto";
import "promotionInfoService.proto";
import "adjustmentService.proto";

service CartService {
    //加入购物车商品
    rpc Add (CartRequest) returns (CartResponse) {}
    //设置购物车商品数量
    rpc Set (CartRequest) returns (CartResponse) {}
    //删除购物车商品
    rpc Remove (CartRequest) returns (CartResponse){}
    //清除购物车
    rpc Clear (CartRequest) returns (CartResponse) {}
    //获取购物车
    rpc Get (CartRequest) returns (CartResponse) {}
    //选中商品计算
    rpc Checked (CartRequest) returns (CartResponse) {}
}

message Cart {
    string code =1;
    string currency =2;
    int32 total_num =3;
    int64 total_weight =4;
    int64 total_price =5;
    int64 total_discount =6;
    int64 total_amount =7;
    int64 freight_fee =8;
    int64 insure_fee =9;
    int64 pack_fee =10;
    int64 member_id = 11;
    int64 address_id = 12;
    int32 checked_status = 13;
    repeated CartItem skus = 14;
    repeated PromotionInfo promotions =15;//店铺营销活动
    repeated Adjustment adjustments =16;//变动记录
    repeated SkuInfo presents =17; //可获得的赠品
}

message CartItem {
    int64 sku_id = 1;
    int32 num = 2;
    int64 price = 3;
    int64 promotion_price = 4;
    int64 subtotal_amount = 5;
    int64 subtotal_discount = 6;
    bool checked = 7;
    SkuInfo sku = 8;
    repeated PromotionInfo promotions =9;
}

message CartRequest {
    int32 paged = 1;
    int32 page_size = 2;
    string keywords = 3;
    string row_id =4;
    int64 sku_id =5;
    string direction =6;
    int32 num =7;
    repeated int64 sku_ids =8;
    map<int64,int32> sku_list =9;
}

message CartData {
    Cart entity = 1;
    common.Pager pager =2;
    repeated Cart items = 3;
    common.Info info =4;
}

message CartResponse {
    CartData data = 1;
    common.Error error = 2;
}
