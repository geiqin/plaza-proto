syntax = "proto3";
package services;
option go_package = "/.;services";
import "common/base.proto";
import "spuPropertyService.proto";
import "brandService.proto";
import "categoryService.proto";
import "termService.proto";
import "tagService.proto";
import "spuGalleryService.proto";
import "skuVipService.proto";
import "skuCouponService.proto";
import "skuPresaleService.proto";

//操作编辑为主
service SpuService {
    //创建商品
    rpc Create(Spu) returns (SpuResponse);
    //修改商品
    rpc Update(Spu) returns (SpuResponse);
    //删除商品
    rpc Delete (Spu) returns (SpuResponse);
    //获取商品（编辑显示）
    rpc Get (Spu) returns (SpuResponse);
    //商品操作
    rpc Action (SkuRequest) returns (SpuResponse);
    //商品上下架
    rpc Sale (SkuRequest) returns (SpuResponse);
    //商品排序
    rpc Sort(SkuRequest) returns (SpuResponse);
    //获取列表(后台服务)
    rpc List (SkuRequest) returns (SkuResponse);
}

//货品查询（基于后台及服务）
service SkuService {
    //获取货品
    rpc Get (Sku) returns (SkuResponse);
    //获取货品详情
    rpc Detail (Sku) returns (SkuResponse);
    //获取列表
    rpc List (SkuRequest) returns (SkuResponse);
    //货品查询（基于SKU查询）
    rpc Search (SkuRequest) returns (SkuResponse);
}

//商品信息（查询/显示）
service ProductService {
    //商品查询【后端使用】
    rpc Search (SkuRequest) returns (SpuResponse);
    //商品详情查询【后端使用】
    rpc SkuSearch (SkuRequest) returns (SpuResponse);
    //商品详情显示【后端使用】
    rpc Display (SkuRequest) returns (SpuResponse);
    //商品查询【前端使用】
    rpc FrontSearch (SkuRequest) returns (SpuResponse);
    //商品详情显示【前端使用】
    rpc FrontDisplay (SkuRequest) returns (SpuResponse);
}

message Sku {
    int64 id = 1;
    int64 spu_id = 2;
    string sku_sn = 3;
    string title = 4;
    string type = 5;
    string subtype = 6;
    string unit = 7;
    int64 shop_id = 8;
    int64 image_id = 9;
    string image_url = 10;
    int64 price = 11;
    int64 market_price = 12;
    int64 cost_price = 13;
    int64 promotion_price = 14;
    string barcode = 15;
    int64 weight = 16;
    int32 volume = 17;
    int32 stock = 18;
    int32 frozen_stock = 19;
    string out_sku_no = 20;
    bool is_spec = 21;
    bool is_virtual = 22;
    bool is_presale = 23;
    bool is_member_right = 24;
    bool is_member_price = 25;
    bool is_hide_stock = 26;
    bool is_new = 27;
    bool is_hot = 28;
    bool is_recommend = 29;
    bool is_special = 30;
    bool is_master = 31;
    string indexes =32;
    string index_pos =33;
    string status = 34;
    string listed_at = 35;
    string created_at = 36;
    string updated_at = 37;
    repeated int32 indexes_data = 38;
    map<int32,string> own_desc_data = 39;
    Spu spu = 40;
    SkuVip vip = 41;
    SkuCoupon coupon = 42;
    SkuPresale presale = 43;
    repeated SpuGallery galleries = 44;
    repeated OwnProperty own_property =45;
}

message Spu {
    int64 id = 1;
    string code = 2;
    string title = 3;
    string type = 4;
    string subtype = 5;
    string unit = 6;
    int32 category_id = 7;
    string category_ids = 8;
    int32 brand_id = 9;
    int64 shop_id = 10;
    int32 max_buy = 11;
    int32 min_buy = 12;
    int64 province_id = 13;
    int64 city_id = 14;
    int64 thumb_id = 15;
    string thumb_url = 16;
    int64 video_id = 17;
    string video_url = 18;
    int32 template_id = 19;
    string keywords = 20;
    string out_spu_no = 21;
    int64 min_price = 22;
    int64 max_price = 23;
    int32 stocks = 24;
    int32 collects = 25;
    int32 evaluates = 26;
    int32 shares = 27;
    int32 clicks = 28;
    int32 sales = 29;
    int32 sale_initial = 30;
    int32 sale_actual = 31;
    int32 child_num = 32;
    int64 master_sku_id = 33;
    bool is_spec = 34;
    int32 sort = 35;
    string memo = 36;
    int32 button_mode = 37;
    string button_custom = 38;
    repeated string shipment_codes = 39;
    int32 freight_mode = 40;
    int64 uniform_freight = 41;
    int32 express_id = 42;
    repeated string after_sale_codes = 43;
    string status = 44;
    string created_at = 45;
    string updated_at = 46;
    SpuDesc desc = 47;
    Brand brand = 48;
    Category category = 49;
    Sku sku = 50;
    repeated Term terms = 51;
    repeated Tag tags = 52;
    repeated Sku skus = 53;
    repeated SpuGallery galleries = 54;
    GenericProperty generic_property = 55;
    repeated SaleProperty sale_property =56;
    repeated ServiceProperty service_property =57;
    repeated PromotionInfo promotions =58;
}

message SpuDesc {
    string content = 1;
    string packing_list = 2;
    string after_service = 3;
}

//参与的活动
message PromotionInfo {
    int64 id = 1; //活动ID
    string code = 2; //活动编码:如：coupon_20210101212
    string title = 3; //活动标题
    string type = 4; //活动类型:Coupon优惠劵/满减送/限时折扣/秒杀/拼团/通用
    string subtype = 5; //活动子类型
    string tag = 6; //标签
    repeated string preferential_items =7; //优惠项目描述
}

message SkuRequest {
    int32 paged = 1;
    int32 page_size = 2;
    string keywords = 3;
    int64 sku_id = 8;
    string sku_sn = 9;
    int64 spu_id = 4;
    string code = 5;
    string title = 6;
    string type = 7;
    int32 category_id = 10;
    int32 term_id = 11;
    string term_name = 12;
    int32 brand_id = 13;
    int64 shop_id = 14;
    string status =15;
    string start_date =16;
    string end_date =17;
    int32 param_id = 18;
    string param_value = 19;
    int32 tag_id = 20;
    string tag_name = 21;
    string subtype =22;
    int32 sort =23;
    repeated int64 spu_ids = 24;
    repeated int64 sku_ids = 25;
    repeated int64 brand_ids = 26;
    repeated int64 tag_ids = 27;
    repeated int64 term_ids = 28;
}

message SkuData {
    Sku entity = 2;
    common.Pager pager = 3;
    repeated Sku items = 4;
    common.Info info = 5;
}

message SkuResponse {
    SkuData data = 1;
    common.Error error = 2;
}

message SpuResponse {
    SpuData data = 1;
    common.Error error = 2;
}

message SpuData {
    Spu entity = 1;
    common.Pager pager = 3;
    repeated Spu items = 4;
    common.Info info = 5;
}
