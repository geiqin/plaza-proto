syntax = "proto3";
package services;
option go_package ="/.;services";
import "common/base.proto";

//下载信息
service DownloadService {
    //生成下载文件开始
    rpc BuildBegin (Download) returns (DownloadResponse) {}
    //生成下载文件结束
    rpc BuildEnd (Download) returns (DownloadResponse) {}
    //创建下载信息
    rpc Create (Download) returns (DownloadResponse) {}
    //修改下载信息
    rpc Update (Download) returns (DownloadResponse) {}
    //删除下载信息
    rpc Delete (Download) returns (DownloadResponse) {}
    //获得下载信息
    rpc Get (Download) returns (DownloadResponse) {}
    //生成下载地址
    rpc MakeUrl (Download) returns (DownloadUrlResponse) {}
    //查询下载信息
    rpc Search (DownloadRequest) returns (DownloadResponse) {}
}

// 下载信息
message Download {
    int64 id =1;
    string hash =2;
    string title =3;
    string type =4;
    string file_name =5;
    string raw_name =6;
    string save_path =7;
    string url =8;
    string mime_type =9;
    int64 size =10;
    string memo =11;
    string private_download_url =12;
    int64 private_download_deadline =13;
    string user_type	=14;
    int64 user_id	=15;
    string status	=16;
    string built_at =17;
    string created_at =18;
    string updated_at =19;
}

message DownloadRequest {
    int32 paged = 1;
    int32 page_size = 2;
    int32 top = 3;
    //base params
    int64 id = 4;
    string name = 6;
    string title = 7;
    string hash = 8;
    string status =9;
    string built_at =10;
    string created_at =11;
    string updated_at =12;
    repeated int64 ids = 13;
}

message DownloadUrlData {
    string  url = 1;
    int64 deadline = 2;
}

message DownloadUrlResponse {
    DownloadUrlData data = 1;
    common.Error error = 2;
}

message DownloadData {
    Download entity = 1;
    common.Pager pager =2;
    repeated Download items = 3;
    common.Info info =4;
}

message DownloadResponse {
    DownloadData data = 1;
    common.Error error = 2;
}
